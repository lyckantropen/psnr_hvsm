#pragma once
#include <xtensor/xtensor.hpp>

constexpr double MASK_COEFF[64] =
    {0.390625, 0.826446, 1.000000, 0.390625, 0.173611, 0.062500, 0.038447, 0.026874,
     0.694444, 0.694444, 0.510204, 0.277008, 0.147929, 0.029727, 0.027778, 0.033058,
     0.510204, 0.591716, 0.390625, 0.173611, 0.062500, 0.030779, 0.021004, 0.031888,
     0.510204, 0.346021, 0.206612, 0.118906, 0.038447, 0.013212, 0.015625, 0.026015,
     0.308642, 0.206612, 0.073046, 0.031888, 0.021626, 0.008417, 0.009426, 0.016866,
     0.173611, 0.081633, 0.033058, 0.024414, 0.015242, 0.009246, 0.007831, 0.011815,
     0.041649, 0.024414, 0.016437, 0.013212, 0.009426, 0.006830, 0.006944, 0.009803,
     0.019290, 0.011815, 0.011080, 0.010412, 0.007972, 0.010000, 0.009426, 0.010203};

double masking(const xt::xtensor<double, 2> &tile, const xt::xtensor<double, 2> &tile_dct);
double hvsm_mse_tile(const xt::xtensor<double, 2> &, const xt::xtensor<double, 2> &);
xt::xtensor<double, 2> hvsm_mse(const xt::xtensor<double, 2> &, const xt::xtensor<double, 2> &);
